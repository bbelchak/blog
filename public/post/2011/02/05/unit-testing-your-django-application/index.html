<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>unit testing your django application :: belchak.com — A blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Unit testing is a very important part of any software project. It helps you know that the new code you are deploying works, and isn&amp;rsquo;t going to blow up in your face. It also helps you feel good about changing large chunks of code without destroying everything you&amp;rsquo;ve done for the last 3 years.
Unit testing with django is as simple as pie. The documentation is very good, and you can learn a lot about more advanced testing methods from the python documentation."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://belchak.com/post/2011/02/05/unit-testing-your-django-application/" />


<link rel="stylesheet" href="https://belchak.com/assets/style.css">

  <link rel="stylesheet" href="https://belchak.com/assets/blue.css">



<link rel="stylesheet" href="https://belchak.com/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://belchak.com/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://belchak.com/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="unit testing your django application :: belchak.com — A blog" />
<meta name="twitter:description" content="Unit testing is a very important part of any software project. It helps you know that the new code you are deploying works, and isn&amp;rsquo;t going to blow up in your face. It also helps you feel good about changing large chunks of code without destroying everything you&amp;rsquo;ve done for the last 3 years.
Unit testing with django is as simple as pie. The documentation is very good, and you can learn a lot about more advanced testing methods from the python documentation." />
<meta name="twitter:site" content="https://belchak.com/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="unit testing your django application :: belchak.com — A blog">
<meta property="og:description" content="Unit testing is a very important part of any software project. It helps you know that the new code you are deploying works, and isn&amp;rsquo;t going to blow up in your face. It also helps you feel good about changing large chunks of code without destroying everything you&amp;rsquo;ve done for the last 3 years.
Unit testing with django is as simple as pie. The documentation is very good, and you can learn a lot about more advanced testing methods from the python documentation." />
<meta property="og:url" content="https://belchak.com/post/2011/02/05/unit-testing-your-django-application/" />
<meta property="og:site_name" content="unit testing your django application" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:section" content="django" /><meta property="article:section" content="python" /><meta property="article:section" content="Technology" />
<meta property="article:published_time" content="2011-02-05 00:00:00 &#43;0000 UTC" />







</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    belchak.com
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/post">Posts</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/post">Posts</a></li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  <div class="post">
    <h1 class="post-title"><a href="https://belchak.com/post/2011/02/05/unit-testing-your-django-application/">unit testing your django application</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2011-02-05
      </span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="https://belchak.com/tags/django/">django</a>&nbsp;
        
          #<a href="https://belchak.com/tags/python/">python</a>&nbsp;
        
          #<a href="https://belchak.com/tags/unit-testing/">unit testing</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>Unit testing is a very important part of any software project. It helps you know that the new code you are deploying works, and isn&rsquo;t going to blow up in your face. It also helps you feel good about changing large chunks of code without destroying everything you&rsquo;ve done for the last 3 years.</p>

<p>Unit testing with django is as simple as pie. <a href="http://docs.djangoproject.com/en/dev/topics/testing/">The documentation</a> is very good, and you can learn a lot about more advanced testing methods from <a href="http://docs.python.org/library/unittest.html">the python documentation</a>. In this blog post, I aim to show a quick way to get up and running with testing your django application.</p>

<p>First, if you are just starting out, make sure you put a high emphasis on testing your application, otherwise you are going to end up with a bunch of code that has never been tested and you will find yourself writing code for weeks just to get partial coverage on the code you&rsquo;ve already written. Starting off on the right foot is a much better approach, and you will find life much more enjoyable.</p>

<p>Let&rsquo;s get started&hellip;</p>

<p>First of all, you need to define your models:</p>

<pre><code class="language-python">from django.db import models
from django.contrib.auth.models import User

class Post(models.Model):
    title = models.CharField(max_length=50)
    body = models.TextField()
    author = models.ForeignKey(User, related_name=&quot;news_post&quot;)
    date = models.DateTimeField()
    users_read = models.ManyToManyField(User, related_name=&quot;users&quot;, blank=True)

    def __str__(self):
        return self.title
</code></pre>

<p>What we have done here is created a news post item. Let&rsquo;s test it!</p>

<pre><code class="language-python">class PostTestCase(TestCase):
    fixtures = ['test_data.json']
    def setUp(self):
        self.user = User.objects.create_user('newsposter',
                                             'newsposter@news.com', 'newspass')
        self.post = Post.objects.create(title=&quot;Test Post #1&quot;,
                body=&quot;Test Post #1 Body&quot;,
                author=self.user,
                date=datetime.datetime.now())
        self.c = Client()


    def test_post_creation(self):
        &quot;&quot;&quot;
        Tests that we can create a Post
        &quot;&quot;&quot;
        self.assertEqual(self.post.title, &quot;Test Post #1&quot;)
        self.assertEqual(self.post.author, self.user)

    def test_user_can_read(self):
        &quot;&quot;&quot;
        Tests that a user is allowed to read.
        &quot;&quot;&quot;
        self.c.login(username='newsposter', password='newspass')
        response = self.c.get('/news/get_post/1/')
        self.assertEqual(response.status_code, 200)
        self.assertNotEqual(response.content, '{}')
</code></pre>

<p>One of the really cool thing about testing with django is that it comes with a testing client that allows you to make requests just like a real user would. As you can see in our <code>test_user_can_read()</code> method, we have used the client to make a GET request against a URL. You can make a POST request just as easily:</p>

<pre><code class="language-python">def test_i_read_this(self):
    &quot;&quot;&quot;
    Tests a new user marking the story as read.
    &quot;&quot;&quot;
    self.c.login(username='newsposter', password='newspass')
    response = self.c.post('/news/read/1/', {'add':True})
    self.assertEqual(response.status_code, 200)
    self.assertEquals(response.content, '{\n    &quot;read&quot;: true\n}')
</code></pre>

<p>In the previous code sample, the client sends a POST request to <code>/news/read/1/</code> with the <code>{'add':True}</code> data. This gets converted to form data and submitted via the POST. The request returns back JSON, which we match up against what we expect it to return.</p>

<p>Here are some things to remember when you are writing your test cases:</p>

<ul>
<li><p><code>setUp()</code> gets called before <strong>every</strong> test method in your TestCase.</p></li>

<li><p><code>tearDown()</code> gets called after <strong>every</strong> test method in your TestCase.</p></li>

<li><p>Test methods <strong>must</strong> start with &ldquo;test&rdquo; otherwise they will not be executed. It is safe to have other methods in your TestCase that do not begin with &ldquo;test&rdquo; if you want to abstract functionality for multiple test methods into a single function.</p></li>

<li><p>Django creates a test database for you, populates it, runs any south migrations (if you are using south), and then destroys it.</p></li>

<li><p>Do not expect that data that is available in one of your test methods will be available in another. Each test method starts with a blank data slate. If you need data instantiated before your tests are run, consider using the <code>setUp()</code> and <code>tearDown()</code> methods, or using fixtures. You can specify fixtures other than your initial_data fixtures by adding <code>fixtures = ['test_data.json']</code> to your TestCase class.</p></li>
</ul>

<p>Here is in-depth documentation about what assert methods are available to you in different versions of Python in <a href="http://docs.python.org/library/unittest.html#test-cases">the official Python unittest documentation</a>.</p>

<p>As you can see, testing with django is really really simple, but very powerful. In my next post, I will discuss how to test django with a MongoDB backend that does not use the ORM.</p>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://belchak.com/post/2011/02/07/unit-testing-django-with-a-nosql-backend/">
                <span class="button__icon">←</span>
                <span class="button__text">unit testing django with a nosql backend</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://belchak.com/post/2011/01/31/code-completion-for-python-and-django-in-vim/">
                <span class="button__text">code completion for python and django in vim</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="https://belchak.com/assets/main.js"></script>
<script src="https://belchak.com/assets/prism.js"></script>

  
</div>

</body>
</html>
